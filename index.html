<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Storm Analysis Dashboard</title>
  <!-- Import Vega & Vega-Lite (does not have to be from CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
  
  <!-- Dashboard State Manager -->
  <script src="js/dashboard-state.js"></script>
  
  <!-- CSS file -->
  <link rel="stylesheet" type="text/css" href="css/styles.css" media="all">
  
</head>
<body>
<h1>Storm Analysis Dashboard</h1>

<div class="intro-section">
  <p class="intro-text">
    This interactive dashboard provides a comprehensive analysis of global storm patterns and natural disaster impacts spanning from 2005 to 2025.
    By examining multiple data dimensions - from economic damages and mortality rates to geographic distribution and storm classifications - users can gain deep insights into how natural disasters, particularly storms, have shaped our world over the past two decades.
    The dashboard features synchronized visualizations that allow you to explore temporal trends, compare disaster types, and understand the evolving nature of storm impacts globally.    
    <br><br>
    Use the year control in the top-right corner to filter all charts simultaneously and discover how storm patterns and disaster consequences have changed over time.
    Red highlighting throughout the visualizations emphasizes storm-related disasters, revealing their significant contribution to global disaster impacts compared to other natural hazards.
  </p>
</div>

<!-- Floating Year Control -->
<div class="floating-controls">
  <div class="floating-year-control">
    <div class="control-header">
      <span class="control-title">Year</span>
      <button class="toggle-btn" id="toggleControls">-</button>
    </div>
    <div class="control-content" id="controlContent">
      <div class="year-slider-container">
        <label for="globalYear">Year: </label>
        <input type="range" id="globalYear" min="2005" max="2025" step="1" value="2010">
        <span id="yearDisplay" class="year-display">2010</span>
      </div>
      <div class="year-info">
        <small>Drag to change year for all charts</small>
      </div>
    </div>
  </div>
</div>

<div class="charts-side-by-side">
  <div class="chart-container">
    <div id="symbol_map"></div>
  </div>
  
  <div class="chart-container">
    <div id="pie_chart"></div>
  </div>
</div>
<div class="analysis-section">
  <p class="analysis-text">
  The spatial distribution of storm origins makes the physical drivers obvious: most genesis points cluster over warm tropical and subtropical oceans, where sea-surface temperatures and atmospheric conditions favour cyclone formation. The map shows dense source regions in the tropical Atlantic and Pacific basins, while the companion pie chart breaks down storm classifications for the selected year - typically showing tropical cyclones and disturbances as the largest categories.
    <br><br>
    This geographic concentration explains why coastal and island nations face disproportionate exposure: a large fraction of storms form and track over ocean corridors that make landfall in a relatively small set of countries. Comparing the map and pie chart through time helps identify shifts in storm type composition or basin activity that drive changes in risk for different regions.
  </p>
</div>

<div id="line_chart"></div>
<div class="analysis-section">
  <p class="analysis-text">
    The multi-year line chart reveals an oscillatory signal in storm counts that is consistent with known modes of climate variability such as the El Ni√±o-Southern Oscillation (ENSO) and other ocean-atmosphere patterns. These modes influence sea-surface temperatures and atmospheric circulation, which in turn affect storm formation and basin activity across multi-year periods.
    <br><br>
    It is important to couple this frequency information with the impact-focused charts (economic damages and deaths): an increase in storm counts does not always translate into higher societal impacts if storms are weaker or affect less vulnerable locations. The highlighted selected-year marker makes it easy to compare the absolute number of storms to the contemporaneous economic and human consequences shown elsewhere on the dashboard.
  </p>
</div>

<div id="area_chart"></div>
<div class="analysis-section">
  <p class="analysis-text">
    The economic impact analysis reveals that storms consistently represent the highest proportion of economic damages across most years in the dataset, demonstrating their significant financial burden on global economies. This dominance can be attributed to several factors: the high frequency of storm occurrences compared to other natural disasters, their ability to affect large geographic areas simultaneously, and their tendency to damage critical infrastructure and economic centers along coastlines. 
    <br><br>
    Flooding appears as the second-highest contributor to economic damages, which is directly linked to storm activity as heavy rainfall and storm surge are primary causes of flood-related economic losses. The data shows interesting temporal patterns, with some years exhibiting particularly high storm-related economic impacts, likely corresponding to major hurricane seasons or significant cyclone events. 
    <br><br>
    While other disasters like earthquakes and droughts may be more severe in terms of immediate destruction or long-term effects, the frequency factor gives storms their prominent position in the economic damage hierarchy. The visualization also reveals the interconnected nature of disaster impacts, as storm-induced flooding amplifies the overall economic burden of weather-related events.
  </p>
</div>

<div id="area_chart_deaths"></div>
<div class="analysis-section">
  <p class="analysis-text">
    While advances in forecasting, early warning systems, and emergency response have reduced fatalities from storms in many regions, storms continue to be a major cause of disaster-related deaths worldwide. The deaths area chart shows that, although other hazards such as earthquakes or heatwaves can produce very large single-year mortality spikes, storms consistently contribute a substantial share of annual disaster fatalities - often on the order of 20-30% in many years.
    <br><br>
    Mortality is driven not only by storm intensity, but also by exposure and vulnerability: densely populated coastal zones, fragile infrastructure, and gaps in preparedness or evacuation capacity amplify human impacts. The chart highlights specific years with anomalous spikes; linking those years to the geographic and economic views helps reveal whether high mortality arose from especially severe storms, widespread flooding, or failures in protective systems.
  </p>
</div>


<script type="text/javascript">
  // Initialize dashboard when page loads
  document.addEventListener('DOMContentLoaded', async function() {
    try {
      // Initialize the global dashboard state
      GlobalDashboardState.init();
      
      // Add example event listener
      GlobalDashboardState.addEventListener('yearChange', function(data) {
        console.log('Year changed from', data.oldYear, 'to', data.newYear);
      });
      
      // Load all visualizations using the dashboard state manager
      await Promise.all([
        GlobalDashboardState.loadVisualization('#line_chart', 'js/line_chart.vg.json', 'lineChart'),
        GlobalDashboardState.loadVisualization('#symbol_map', 'js/dotmap_map.vg.json', 'symbolMap'),
        GlobalDashboardState.loadVisualization('#area_chart', 'js/area_chart_disasters.vg.json', 'areaChart'),
        GlobalDashboardState.loadVisualization('#area_chart_deaths', 'js/area_chart_deaths.vg.json', 'areaChartDeaths'),
        GlobalDashboardState.loadVisualization('#pie_chart', 'js/pie_chart_storm_types.vg.json', 'pieChart')
      ]);
      
      console.log('Dashboard loaded successfully!');
      console.log('Current state:', GlobalDashboardState.getState());
      
    } catch (error) {
      console.error('Error loading dashboard:', error);
    }
  });

  // Add floating controls functionality
  document.addEventListener('DOMContentLoaded', function() {
    const toggleBtn = document.getElementById('toggleControls');
    const controlContent = document.getElementById('controlContent');
    let isExpanded = true;

    toggleBtn.addEventListener('click', function() {
      isExpanded = !isExpanded;
      
      if (isExpanded) {
        controlContent.style.display = 'block';
        toggleBtn.textContent = '-';
        toggleBtn.setAttribute('aria-label', 'Collapse controls');
      } else {
        controlContent.style.display = 'none';
        toggleBtn.textContent = '+';
        toggleBtn.setAttribute('aria-label', 'Expand controls');
      }
    });

    // Add keyboard support
    toggleBtn.addEventListener('keydown', function(e) {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        toggleBtn.click();
      }
    });
  });
</script>

<!-- Data Sources Footer -->
<footer class="data-sources">
  <h3>Data Sources</h3>
  <div class="sources-links">
    <div class="source-item">
      <strong>Natural Disasters Data:</strong> 
      <a href="https://ourworldindata.org/natural-disasters" target="_blank" rel="noopener noreferrer">
        Our World in Data - Natural Disasters
      </a>
    </div>
    <div class="source-item">
      <strong>Tropical Cyclone Data:</strong> 
      <a href="https://climatedataguide.ucar.edu/climate-data/ibtracs-tropical-cyclone-best-track-data" target="_blank" rel="noopener noreferrer">
        IBTrACS - Tropical Cyclone Best Track Data
      </a>
    </div>
  </div>
  
  <div class="author-info">
    <p>Created by <strong>James Nguyen</strong> | October 2025</p>
  </div>
  
  <div class="ai-acknowledgement">
    <h4>AI acknowledgement statement</h4>
    <p><em>I used GitHub Copilot to assist with code development, data processing, and visualization implementation across multiple iterations. I modified the outputs by customizing the analysis text, adjusting visual styling, and refining the interactive dashboard functionality.</em></p>
  </div>
</footer>

</body>
</html>