{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 900,
    "height": 500,
    "projection": { "type": "naturalEarth1" },
    "params": [
        {
            "name": "timeInterval",
            "value": "2005-2009",
            "bind": {
                "input": "select",
                "options": ["2005-2009", "2010-2014", "2015-2019", "2020-2025"],
                "labels": ["2005-2009", "2010-2014", "2015-2019", "2020-2025"],
                "name": "Time Period: "
            }
        }
    ],
    "layer": [
        {
            "data": {
                "url": "https://raw.githubusercontent.com/npnquang/FIT3179-Homework-10/refs/heads/main/data/ne_110m_admin_0_countries.topojson",
                "format": {
                    "type": "topojson",
                    "feature": "ne_110m_admin_0_countries"
                }
            },
            "mark": { "type": "geoshape", "fill": "#eee", "stroke": "#999" }
        },
        {
            "data": {
                "url": "data/ne_110m_graticules_30.json",
                "format": {
                    "type": "topojson",
                    "feature": "ne_110m_graticules_30"
                }
            },
            "mark": {
                "type": "geoshape",
                "fill": null,
                "stroke": "#ddd",
                "strokeWidth": 0.5,
                "opacity": 0.7
            }
        },
        {
            "data": {
                "url": "https://raw.githubusercontent.com/npnquang/FIT3179-Homework-10/refs/heads/main/data/ibtracs_first_locations.csv"
            },
            "transform": [
                {
                    "calculate": "datum.YEAR >= 2005 && datum.YEAR <= 2009 ? '2005-2009' : datum.YEAR >= 2010 && datum.YEAR <= 2014 ? '2010-2014' : datum.YEAR >= 2015 && datum.YEAR <= 2019 ? '2015-2019' : datum.YEAR >= 2020 && datum.YEAR <= 2025 ? '2020-2025' : 'Other'",
                    "as": "YearInterval"
                },
                {
                    "filter": "datum.YearInterval == timeInterval"
                }
            ],
            "mark": {
                "type": "circle",
                "opacity": 0.7,
                "size": 60
            },
            "encoding": {
                "longitude": { "field": "LON", "type": "quantitative" },
                "latitude": { "field": "LAT", "type": "quantitative" },
                "color": {
                    "field": "NATURE",
                    "type": "nominal",
                    "title": "Storm Type",
                    "scale": {
                        "domain": [
                            "Tropical",
                            "Extratropical",
                            "Subtropical",
                            "Disturbance",
                            "Mixture(contradicting report from different agencies)",
                            "Not reported"
                        ],
                        "range": [
                            "#d62728",
                            "#ff7f0e",
                            "#2ca02c",
                            "#1f77b4",
                            "#9467bd",
                            "#8c564b"
                        ]
                    },
                    "legend": {
                        "orient": "right",
                        "title": "Storm Type",
                        "titleFontSize": 12,
                        "labelFontSize": 10,
                        "symbolSize": 100,
                        "offset": 20
                    }
                },
                "tooltip": [
                    {
                        "field": "YEAR",
                        "type": "quantitative",
                        "title": "Year"
                    },
                    {
                        "field": "NATURE",
                        "type": "nominal",
                        "title": "Storm Type"
                    }
                ]
            }
        }
    ]
}
